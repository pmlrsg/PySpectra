import unittest
import os

import numpy as np
from numpy.testing import assert_allclose

from PySpectra import extract_spectra_from_file

TEST_INPUTS_DIRECTORY = os.path.join(os.path.dirname(__file__), 'inputs')

class ENVITests(unittest.TestCase):

    correct_wavelengths = np.array([
339.799988,  341.299988,  342.799988,  344.200012,  345.700012,  347.100006,
348.600006,  350.100006,  351.5,  353.0,  354.5,  356.0,
357.399994,  358.899994,  360.399994,  361.799988,  363.299988,  364.799988,
366.200012,  367.700012,  369.200012,  370.600006,  372.100006,  373.600006,
375.0,  376.5,  378.0,  379.399994,  380.899994,  382.399994,
383.799988,  385.299988,  386.799988,  388.200012,  389.700012,  391.100006,
392.600006,  394.100006,  395.5,  397.0,  398.5,  399.899994,
401.399994,  402.799988,  404.299988,  405.799988,  407.200012,  408.700012,
410.100006,  411.600006,  413.0,  414.5,  416.0,  417.399994,
418.899994,  420.299988,  421.799988,  423.200012,  424.700012,  426.100006,
427.600006,  429.0,  430.5,  431.899994,  433.399994,  434.799988,
436.299988,  437.700012,  439.200012,  440.600006,  442.100006,  443.5,
445.0,  446.399994,  447.799988,  449.299988,  450.700012,  452.100006,
453.600006,  455.0,  456.5,  457.899994,  459.299988,  460.799988,
462.200012,  463.600006,  465.100006,  466.5,  467.899994,  469.399994,
470.799988,  472.200012,  473.600006,  475.100006,  476.5,  477.899994,
479.399994,  480.799988,  482.200012,  483.600006,  485.0,  486.5,
487.899994,  489.299988,  490.700012,  492.100006,  493.600006,  495.0,
496.399994,  497.799988,  499.200012,  500.600006,  502.0,  503.5,
504.899994,  506.299988,  507.700012,  509.100006,  510.5,  511.899994,
513.299988,  514.700012,  516.099976,  517.5,  518.900024,  520.299988,
521.700012,  523.200012,  524.5,  526.0,  527.299988,  528.700012,
530.099976,  531.5,  532.900024,  534.299988,  535.700012,  537.099976,
538.5,  539.900024,  541.299988,  542.700012,  544.099976,  545.5,
546.900024,  548.299988,  549.700012,  551.0,  552.400024,  553.799988,
555.200012,  556.599976,  558.0,  559.299988,  560.700012,  562.099976,
563.5,  564.900024,  566.299988,  567.599976,  569.0,  570.400024,
571.799988,  573.200012,  574.5,  575.900024,  577.299988,  578.700012,
580.0,  581.400024,  582.799988,  584.200012,  585.5,  586.900024,
588.299988,  589.700012,  591.0,  592.400024,  593.799988,  595.099976,
596.5,  597.900024,  599.200012,  600.599976,  602.0,  603.299988,
604.700012,  606.099976,  607.400024,  608.799988,  610.200012,  611.5,
612.900024,  614.200012,  615.599976,  617.0,  618.299988,  619.700012,
621.0,  622.400024,  623.799988,  625.099976,  626.5,  627.799988,
629.200012,  630.5,  631.900024,  633.200012,  634.599976,  636.0,
637.299988,  638.700012,  640.0,  641.299988,  642.700012,  644.0,
645.400024,  646.799988,  648.099976,  649.5,  650.799988,  652.099976,
653.5,  654.799988,  656.200012,  657.5,  658.900024,  660.200012,
661.5,  662.900024,  664.200012,  665.599976,  666.900024,  668.299988,
669.599976,  670.900024,  672.299988,  673.599976,  675.0,  676.299988,
677.599976,  679.0,  680.299988,  681.599976,  683.0,  684.299988,
685.599976,  687.0,  688.299988,  689.599976,  691.0,  692.299988,
693.599976,  694.900024,  696.299988,  697.599976,  698.900024,  700.200012,
701.599976,  702.900024,  704.200012,  705.5,  706.900024,  708.200012,
709.5,  710.799988,  712.200012,  713.5,  714.799988,  716.099976,
717.400024,  718.799988,  720.099976,  721.400024,  722.700012,  724.0,
725.299988,  726.599976,  728.0,  729.299988,  730.599976,  731.900024,
733.200012,  734.5,  735.799988,  737.099976,  738.400024,  739.700012,
741.0,  742.299988,  743.599976,  744.900024,  746.200012,  747.5,
748.799988,  750.099976,  751.400024,  752.700012,  754.0,  755.299988,
756.599976,  757.900024,  759.200012,  760.5,  761.799988,  763.099976,
764.400024,  765.700012,  767.0,  768.200012,  769.5,  770.799988,
772.099976,  773.400024,  774.700012,  775.900024,  777.200012,  778.5,
779.799988,  781.0,  782.299988,  783.599976,  784.900024,  786.200012,
787.400024,  788.700012,  790.0,  791.200012,  792.5,  793.799988,
795.0,  796.299988,  797.599976,  798.799988,  800.099976,  801.299988,
802.599976,  803.900024,  805.099976,  806.400024,  807.599976,  808.900024,
810.200012,  811.400024,  812.700012,  813.900024,  815.200012,  816.400024,
817.599976,  818.900024,  820.099976,  821.400024,  822.599976,  823.900024,
825.099976,  826.299988,  827.599976,  828.799988,  830.0,  831.299988,
832.5,  833.700012,  835.0,  836.200012,  837.400024,  838.700012,
839.900024,  841.099976,  842.299988,  843.5,  844.799988,  846.0,
847.200012,  848.400024,  849.599976,  850.799988,  852.099976,  853.299988,
854.5,  855.700012,  856.900024,  858.099976,  859.299988,  860.5,
861.700012,  862.900024,  864.099976,  865.299988,  866.5,  867.700012,
868.900024,  870.099976,  871.299988,  872.5,  873.700012,  874.900024,
876.099976,  877.299988,  878.5,  879.599976,  880.799988,  882.0,
883.200012,  884.400024,  885.5,  886.700012,  887.900024,  889.099976,
890.200012,  891.400024,  892.599976,  893.799988,  894.900024,  896.099976,
897.299988,  898.5,  899.599976,  900.799988,  902.0,  903.099976,
904.299988,  905.400024,  906.599976,  907.799988,  908.900024,  910.099976,
911.200012,  912.400024,  913.5,  914.700012,  915.799988,  917.0,
918.200012,  919.299988,  920.5,  921.599976,  922.799988,  923.900024,
925.099976,  926.200012,  927.299988,  928.5,  929.599976,  930.799988,
931.900024,  933.099976,  934.200012,  935.400024,  936.5,  937.700012,
938.799988,  939.900024,  941.099976,  942.200012,  943.299988,  944.5,
945.599976,  946.799988,  947.900024,  949.0,  950.200012,  951.299988,
952.5,  953.599976,  954.799988,  955.900024,  957.0,  958.200012,
959.299988,  960.5,  961.599976,  962.700012,  963.900024,  965.0,
966.200012,  967.299988,  968.400024,  969.599976,  970.700012,  971.900024,
973.0,  974.200012,  975.299988,  976.5,  977.599976,  978.799988,
979.900024,  981.0,  982.200012,  983.400024,  984.5,  985.700012,
986.799988,  988.0,  989.200012,  990.299988,  991.5,  992.599976,
993.799988,  995.0,  996.200012,  997.299988,  998.5,  999.700012,
1000.799988,  1002.0,  1003.200012,  1004.400024,  1005.599976,  1006.799988,
1008.0,  1009.200012,  970.099976,  973.900024,  977.700012,  981.5,
985.400024,  989.200012,  993.0,  996.799988,  1000.599976,  1004.400024,
1008.200012,  1012.099976,  1015.900024,  1019.700012,  1023.5,  1027.300049,
1031.099976,  1034.900024,  1038.800049,  1042.599976,  1046.400024,  1050.199951,
1054.0,  1057.800049,  1061.599976,  1065.400024,  1069.199951,  1073.0,
1076.800049,  1080.599976,  1084.400024,  1088.199951,  1092.0,  1095.800049,
1099.699951,  1103.400024,  1107.199951,  1111.099976,  1114.800049,  1118.699951,
1122.400024,  1126.199951,  1130.0,  1133.800049,  1137.599976,  1141.400024,
1145.199951,  1149.0,  1152.800049,  1156.599976,  1160.400024,  1164.199951,
1168.0,  1171.800049,  1175.5,  1179.300049,  1183.099976,  1186.900024,
1190.699951,  1194.5,  1198.199951,  1202.0,  1205.800049,  1209.599976,
1213.400024,  1217.199951,  1220.900024,  1224.699951,  1228.5,  1232.199951,
1236.0,  1239.800049,  1243.599976,  1247.300049,  1251.099976,  1254.900024,
1258.699951,  1262.400024,  1266.199951,  1269.900024,  1273.699951,  1277.5,
1281.199951,  1285.0,  1288.800049,  1292.5,  1296.300049,  1300.0,
1303.800049,  1307.5,  1311.300049,  1315.0,  1318.800049,  1322.599976,
1326.300049,  1330.0,  1333.800049,  1337.5,  1341.300049,  1345.0,
1348.800049,  1352.5,  1356.199951,  1360.0,  1363.699951,  1367.400024,
1371.199951,  1374.900024,  1378.699951,  1382.400024,  1386.099976,  1389.800049,
1393.599976,  1397.300049,  1401.0,  1404.699951,  1408.5,  1412.199951,
1415.900024,  1419.599976,  1423.300049,  1427.099976,  1430.800049,  1434.5,
1438.199951,  1441.900024,  1445.599976,  1449.300049,  1453.0,  1456.699951,
1460.400024,  1464.099976,  1467.800049,  1471.5,  1475.199951,  1478.900024,
1482.599976,  1486.300049,  1490.0,  1493.699951,  1497.400024,  1501.099976,
1504.699951,  1508.400024,  1512.099976,  1515.800049,  1519.5,  1523.099976,
1526.800049,  1530.5,  1534.199951,  1537.800049,  1541.5,  1545.199951,
1548.800049,  1552.5,  1556.199951,  1559.800049,  1563.5,  1567.099976,
1570.800049,  1574.400024,  1578.099976,  1581.699951,  1585.400024,  1589.0,
1592.699951,  1596.300049,  1599.900024,  1603.599976,  1607.199951,  1610.900024,
1614.5,  1618.099976,  1621.800049,  1625.400024,  1629.0,  1632.599976,
1636.300049,  1639.900024,  1643.5,  1647.099976,  1650.699951,  1654.300049,
1658.0,  1661.599976,  1665.199951,  1668.800049,  1672.400024,  1676.0,
1679.599976,  1683.199951,  1686.800049,  1690.400024,  1694.0,  1697.599976,
1701.199951,  1704.699951,  1708.300049,  1711.900024,  1715.5,  1719.099976,
1722.599976,  1726.199951,  1729.800049,  1733.300049,  1736.900024,  1740.5,
1744.0,  1747.599976,  1751.199951,  1754.699951,  1758.300049,  1761.800049,
1765.400024,  1768.900024,  1772.5,  1776.0,  1779.599976,  1783.099976,
1786.599976,  1790.199951,  1793.699951,  1797.199951,  1800.800049,  1804.300049,
1807.800049,  1811.300049,  1814.800049,  1818.400024,  1821.900024,  1825.400024,
1828.900024,  1832.400024,  1835.900024,  1839.400024,  1842.900024,  1846.400024,
1849.900024,  1853.400024,  1856.900024,  1860.400024,  1863.900024,  1867.400024,
1870.800049,  1874.300049,  1877.800049,  1881.300049,  1884.699951,  1888.199951,
1891.699951,  1895.099976,  1898.599976,  1902.800049,  1905.5,  1908.199951,
1910.900024,  1913.5,  1916.199951,  1918.900024,  1921.599976,  1924.199951,
1926.900024,  1929.599976,  1932.199951,  1934.900024,  1937.5,  1940.199951,
1942.800049,  1945.5,  1948.099976,  1950.800049,  1953.400024,  1956.099976,
1958.699951,  1961.300049,  1964.0,  1966.599976,  1969.199951,  1971.800049,
1974.5,  1977.099976,  1979.699951,  1982.300049,  1984.900024,  1987.599976,
1990.199951,  1992.800049,  1995.400024,  1998.0,  2000.599976,  2003.199951,
2005.800049,  2008.400024,  2011.0,  2013.599976,  2016.199951,  2018.800049,
2021.300049,  2023.900024,  2026.5,  2029.099976,  2031.699951,  2034.199951,
2036.800049,  2039.400024,  2041.900024,  2044.5,  2047.099976,  2049.600098,
2052.199951,  2054.800049,  2057.300049,  2059.899902,  2062.399902,  2064.899902,
2067.5,  2070.0,  2072.600098,  2075.100098,  2077.699951,  2080.199951,
2082.699951,  2085.199951,  2087.800049,  2090.300049,  2092.800049,  2095.399902,
2097.899902,  2100.399902,  2102.899902,  2105.399902,  2107.899902,  2110.399902,
2112.899902,  2115.399902,  2117.899902,  2120.399902,  2122.899902,  2125.399902,
2127.899902,  2130.399902,  2132.899902,  2135.399902,  2137.899902,  2140.399902,
2142.800049,  2145.300049,  2147.800049,  2150.300049,  2152.699951,  2155.199951,
2157.699951,  2160.100098,  2162.600098,  2165.100098,  2167.5,  2170.0,
2172.399902,  2174.899902,  2177.300049,  2179.800049,  2182.199951,  2184.699951,
2187.100098,  2189.5,  2192.0,  2194.399902,  2196.800049,  2199.300049,
2201.699951,  2204.100098,  2206.5,  2209.0,  2211.399902,  2213.800049,
2216.199951,  2218.600098,  2221.0,  2223.399902,  2225.800049,  2228.199951,
2230.600098,  2233.0,  2235.399902,  2237.800049,  2240.199951,  2242.600098,
2245.0,  2247.399902,  2249.800049,  2252.100098,  2254.5,  2256.899902,
2259.300049,  2261.600098,  2264.0,  2266.399902,  2268.800049,  2271.100098,
2273.5,  2275.800049,  2278.199951,  2280.600098,  2282.899902,  2285.199951,
2287.600098,  2289.899902,  2292.300049,  2294.600098,  2297.0,  2299.300049,
2301.600098,  2304.0,  2306.300049,  2308.600098,  2311.0,  2313.300049,
2315.600098,  2317.899902,  2320.199951,  2322.600098,  2324.899902,  2327.199951,
2329.5,  2331.800049,  2334.100098,  2336.399902,  2338.699951,  2341.0,
2343.300049,  2345.600098,  2347.899902,  2350.199951,  2352.399902,  2354.699951,
2357.0,  2359.300049,  2361.600098,  2363.800049,  2366.100098,  2368.399902,
2370.600098,  2372.899902,  2375.199951,  2377.399902,  2379.699951,  2382.0,
2384.199951,  2386.5,  2388.699951,  2391.0,  2393.199951,  2395.5,
2397.699951,  2399.899902,  2402.199951,  2404.399902,  2406.600098,  2408.899902,
2411.100098,  2413.300049,  2415.600098,  2417.800049,  2420.0,  2422.199951,
2424.399902,  2426.600098,  2428.899902,  2431.100098,  2433.300049,  2435.5,
2437.699951,  2439.899902,  2442.100098,  2444.300049,  2446.5,  2448.699951,
2450.899902,  2453.100098,  2455.199951,  2457.399902,  2459.600098,  2461.800049,
2463.899902,  2466.100098,  2468.300049,  2470.5,  2472.600098,  2474.800049,
2477.0,  2479.100098,  2481.300049,  2483.399902,  2485.600098,  2487.699951,
2489.899902,  2492.0,  2494.199951,  2496.300049,  2498.5,  2500.600098,
2502.800049,  2504.899902,  2507.0,  2509.100098,  2511.300049,  2513.399902,
2515.5])

    correct_values = np.array([
0.0453069,  0.0455586,  0.0459759,  0.0464069,  0.0468034,
0.0471586,  0.0477414,  0.0482655,  0.0487517,  0.0493414,  0.0499276,
0.0504241,  0.0509586,  0.0515724,  0.0521621,  0.0526241,  0.0530035,
0.0533724,  0.0537138,  0.0539827,  0.0541207,  0.0542034,  0.0542586,
0.0543138,  0.0542966,  0.0542207,  0.0541448,  0.0540897,  0.0540172,
0.0538966,  0.0537483,  0.0535897,  0.0535069,  0.0534,  0.0532931,
0.053169,  0.0530276,  0.0528621,  0.0527517,  0.0526414,  0.0525138,
0.0523862,  0.0522586,  0.052131,  0.0520345,  0.0519379,  0.0518103,
0.0516897,  0.051569,  0.0514724,  0.051369,  0.0512655,  0.0511517,
0.0510483,  0.0509552,  0.0508828,  0.0507897,  0.0507034,  0.0506035,
0.0505069,  0.0504103,  0.0503448,  0.0502793,  0.0501931,  0.0501,
0.0500276,  0.0499414,  0.0498759,  0.0497828,  0.0497172,  0.0496448,
0.0495793,  0.0495138,  0.0494448,  0.0493759,  0.0492965,  0.0492241,
0.049169,  0.0491103,  0.0490552,  0.0490069,  0.0489379,  0.0488793,
0.0488069,  0.0487483,  0.0486966,  0.048631,  0.0485828,  0.0485379,
0.0484931,  0.0484345,  0.0483759,  0.0483103,  0.048269,  0.0482172,
0.048169,  0.0481172,  0.0480793,  0.0480414,  0.0480069,  0.0479724,
0.0479241,  0.0478862,  0.0478448,  0.0478034,  0.047769,  0.0477345,
0.0476966,  0.0476586,  0.047631,  0.0475966,  0.0475586,  0.0475414,
0.0474862,  0.0474655,  0.047431,  0.0474,  0.0473655,  0.0473483,
0.0473172,  0.0473,  0.0472862,  0.047269,  0.0472345,  0.0472035,
0.0471655,  0.0471552,  0.0471483,  0.0471138,  0.0470931,  0.0470759,
0.0470586,  0.0470345,  0.0470172,  0.0470069,  0.0469862,  0.0469828,
0.0469552,  0.0469517,  0.0469241,  0.0469069,  0.0468931,  0.0468759,
0.0468552,  0.0468517,  0.0468414,  0.0468172,  0.0467931,  0.0467862,
0.046769,  0.0467517,  0.0467241,  0.0467138,  0.0467172,  0.0467035,
0.0466828,  0.0466828,  0.0466655,  0.046669,  0.046669,  0.0466759,
0.0466655,  0.0466655,  0.0466586,  0.0466517,  0.0466414,  0.046631,
0.0466207,  0.0466207,  0.0466207,  0.0466034,  0.0466034,  0.0466138,
0.0466069,  0.0465931,  0.0465897,  0.0465828,  0.046569,  0.0465621,
0.046569,  0.046569,  0.0465793,  0.0465655,  0.0465724,  0.0465655,
0.0465621,  0.0465621,  0.0465483,  0.0465517,  0.0465517,  0.0465483,
0.0465483,  0.0465483,  0.0465345,  0.0465379,  0.0465276,  0.046531,
0.046531,  0.0465276,  0.0465241,  0.0465103,  0.0465103,  0.0465069,
0.0465103,  0.0465035,  0.0465,  0.0465,  0.0465034,  0.0465034,
0.0465069,  0.0465069,  0.0465103,  0.0465172,  0.0465207,  0.0465345,
0.0465448,  0.0465379,  0.0465517,  0.0465552,  0.0465724,  0.0465655,
0.0465621,  0.0465621,  0.046569,  0.0465931,  0.0465862,  0.0465862,
0.0465966,  0.0466,  0.0466034,  0.0466069,  0.0466276,  0.0466276,
0.0466276,  0.0466414,  0.0466586,  0.0466621,  0.046669,  0.0466759,
0.0466828,  0.0467069,  0.0467069,  0.0467172,  0.0467345,  0.0467448,
0.0467483,  0.0467586,  0.0467586,  0.0467552,  0.0467552,  0.046769,
0.0467896,  0.0468,  0.0468034,  0.0468172,  0.046831,  0.0468621,
0.0468621,  0.046869,  0.0468724,  0.0468897,  0.0469069,  0.0469241,
0.0469379,  0.0469483,  0.0469621,  0.046969,  0.0469759,  0.047,
0.0470138,  0.0470241,  0.0470138,  0.0470241,  0.0470414,  0.0470621,
0.047069,  0.0470828,  0.0470897,  0.0470966,  0.0471138,  0.0471172,
0.047131,  0.0471379,  0.0471379,  0.0471517,  0.0471724,  0.0471862,
0.0472103,  0.0472276,  0.0472517,  0.0472655,  0.0472759,  0.0472862,
0.0472966,  0.0473104,  0.0473138,  0.0473414,  0.0473448,  0.0473621,
0.0473655,  0.0473896,  0.0473931,  0.0474241,  0.0474207,  0.0474172,
0.0473793,  0.0473724,  0.0473862,  0.0474138,  0.0474414,  0.0474724,
0.0474931,  0.0474965,  0.0475103,  0.047531,  0.0475414,  0.0475379,
0.047569,  0.0475655,  0.0475793,  0.0475931,  0.0476103,  0.0476103,
0.0476172,  0.0476517,  0.0476448,  0.0476483,  0.0476724,  0.0476621,
0.0476724,  0.0477,  0.0477069,  0.0477241,  0.0477207,  0.0477414,
0.0477517,  0.0477621,  0.0477759,  0.0477862,  0.0478,  0.0478069,
0.0478276,  0.0478207,  0.0478483,  0.0478621,  0.0478828,  0.0478793,
0.0479069,  0.0479,  0.0479069,  0.0479103,  0.0479207,  0.0479517,
0.0479552,  0.0479621,  0.0479862,  0.0479965,  0.0480172,  0.0480345,
0.0480379,  0.0480552,  0.0480414,  0.0480552,  0.0480759,  0.0481207,
0.0481207,  0.0481035,  0.0481172,  0.0481448,  0.0481621,  0.0481724,
0.0481862,  0.0481862,  0.0482241,  0.048231,  0.0482414,  0.0482517,
0.0482517,  0.0482621,  0.0483104,  0.0483069,  0.0483552,  0.0483379,
0.0483483,  0.0483586,  0.0483828,  0.048369,  0.0484103,  0.0484207,
0.0484276,  0.0484448,  0.048469,  0.0484724,  0.0484966,  0.0485,
0.0485345,  0.0485379,  0.0485379,  0.0485517,  0.0485828,  0.0485724,
0.0486276,  0.048631,  0.0486345,  0.0486448,  0.0486379,  0.0486552,
0.0486828,  0.0486517,  0.0486931,  0.0486931,  0.0487069,  0.048731,
0.0487793,  0.0487793,  0.0487655,  0.0487276,  0.0487621,  0.0487793,
0.0488069,  0.0488655,  0.0488586,  0.0488621,  0.0488897,  0.0488483,
0.0488793,  0.0489103,  0.0488862,  0.0489448,  0.0489172,  0.0489103,
0.0489759,  0.0489379,  0.0490207,  0.0490966,  0.0490379,  0.0490345,
0.0490966,  0.0490655,  0.0491448,  0.0490897,  0.0491966,  0.0491414,
0.0492138,  0.0491759,  0.0489828,  0.0490586,  0.0490241,  0.0491172,
0.0491448,  0.0488966,  0.0491,  0.0492897,  0.0493379,  0.0493862,
0.0491138,  0.0491793,  0.0491035,  0.0491241,  0.0493483,  0.0492276,
0.0492586,  0.0491103,  0.0494276,  0.0493207,  0.0492897,  0.0492345,
0.049169,  0.0492862,  0.0494483,  0.0494069,  0.0492586,  0.0493034,
0.0492276,  0.0493276,  0.0494552,  0.0494552,  0.0493552,  0.049231,
0.0494172,  0.0495517,  0.0497379,  0.049369,  0.0492931,  0.0491862,
0.0495034,  0.0494241,  0.0493862,  0.0492448,  0.0493965,  0.0494379,
0.0494034,  0.0493483,  0.0497241,  0.0497724,  0.0494931,  0.0494483,
0.0493931,  0.0493483,  0.0493793,  0.0495828,  0.0495345,  0.0494793,
0.0494483,  0.0492828,  0.0496138,  0.0495379,  0.0494621,  0.0494172,
0.0498241,  0.0495517,  0.0496517,  0.0501138,  0.0501379,  0.0501793,
0.0500414,  0.0500759,  0.0501931,  0.0501655,  0.0502655,  0.0503448,
0.0503,  0.0504241,  0.0505241,  0.0504793,  0.0505897,  0.0506069,
0.0507276,  0.0507897,  0.0508172,  0.0508931,  0.0509586,  0.0509448,
0.0510621,  0.0511,  0.0512069,  0.0512655,  0.0513793,  0.0513552,
0.0514759,  0.0514655,  0.0515828,  0.0516483,  0.0517483,  0.0518379,
0.0518862,  0.0519586,  0.0520552,  0.0521379,  0.0522483,  0.0523172,
0.0523586,  0.0524828,  0.0524345,  0.0524414,  0.0525621,  0.0525586,
0.0526345,  0.0527034,  0.0527862,  0.0526069,  0.0526379,  0.0526655,
0.0526483,  0.0526793,  0.0527345,  0.052769,  0.0528414,  0.0528517,
0.0530069,  0.0530138,  0.0530724,  0.053169,  0.0533379,  0.0533897,
0.0533552,  0.0534759,  0.0534966,  0.0535931,  0.0537552,  0.0537552,
0.0538172,  0.0538862,  0.0539828,  0.0539931,  0.0541241,  0.0541621,
0.0542724,  0.0542897,  0.0543828,  0.0543655,  0.0544827,  0.0545552,
0.0546414,  0.0546724,  0.054731,  0.0548069,  0.0548207,  0.0549172,
0.0549448,  0.0550517,  0.0550862,  0.0551345,  0.0552172,  0.0552862,
0.0553517,  0.0553828,  0.0554759,  0.0554724,  0.0555862,  0.0556379,
0.0555,  0.0555103,  0.0553517,  0.0548414,  0.0551897,  0.0558345,
0.0553966,  0.0551103,  0.0528379,  0.0558862,  0.0558241,  0.0569276,
0.0542414,  0.0562517,  0.0571724,  0.0559172,  0.0554069,  0.0562621,
0.0567069,  0.0563517,  0.0570724,  0.0567172,  0.0564276,  0.0563103,
0.0567276,  0.0567862,  0.0566172,  0.0568035,  0.0568828,  0.0567,
0.0568448,  0.0567552,  0.0568034,  0.0569862,  0.0569069,  0.0569724,
0.0571345,  0.0571276,  0.0572448,  0.0571483,  0.0572793,  0.0572897,
0.0574138,  0.0574345,  0.0574828,  0.0575483,  0.0576862,  0.0577172,
0.0578,  0.0578345,  0.0579586,  0.0579897,  0.0580862,  0.058169,
0.0582483,  0.0583034,  0.0583655,  0.0584207,  0.0585069,  0.0585655,
0.0586207,  0.0587069,  0.0588207,  0.058869,  0.0590138,  0.0589241,
0.0590655,  0.0591379,  0.0591862,  0.0593414,  0.0593276,  0.0593897,
0.0594345,  0.0594759,  0.0595276,  0.0595759,  0.059631,  0.0596379,
0.0597138,  0.0596448,  0.0595207,  0.0594138,  0.0591103,  0.0589586,
0.0586586,  0.0584379,  0.0584655,  0.0585931,  0.0589069,  0.059169,
0.059369,  0.0595621,  0.0598,  0.0599414,  0.0601103,  0.0602552,
0.0602828,  0.0602966,  0.0603034,  0.060369,  0.060569,  0.0605655,
0.0605483,  0.0605586,  0.0606897,  0.0606862,  0.0608759,  0.0607862,
0.0610069,  0.0611241,  0.0612586,  0.0613655,  0.0614483,  0.0615621,
0.0615966,  0.0617241,  0.0617862,  0.0617414,  0.0620621,  0.061969,
0.0621276,  0.0620517,  0.0622414,  0.0621862,  0.0621621,  0.062,
0.0620103,  0.0617965,  0.0618276,  0.0610379,  0.0600448,  0.0593517,
0.0581966,  0.0582724,  0.0559,  0.0535896,  0.0572448,  0.0547414,
0.0566793,  0.0576897,  0.0550931,  0.0538276,  0.0576586,  0.0559,
0.0561897,  0.0541586,  0.0559793,  0.0558828,  0.054669,  0.0589103,
0.053831,  0.0580759,  0.0574483,  0.0536655,  0.0582414,  0.0606655,
0.0528483,  0.0484207,  0.0666655,  0.0609414,  0.0547897,  0.051031,
0.0531069,  0.0598138,  0.0547,  0.0503103,  0.0644035,  0.0659414,
0.0568586,  0.0590759,  0.0610276,  0.0624966,  0.0628517,  0.0636552,
0.063769,  0.063031,  0.0640655,  0.0645862,  0.0645862,  0.0641379,
0.0642241,  0.0648897,  0.0650897,  0.0646069,  0.0646759,  0.0648552,
0.0649828,  0.0651517,  0.0650759,  0.0648966,  0.065031,  0.0649965,
0.0649,  0.0648828,  0.0650172,  0.0648276,  0.0646862,  0.0651965,
0.0655448,  0.0657897,  0.0664828,  0.0666276,  0.0665207,  0.0664172,
0.066431,  0.0666655,  0.0668724,  0.0669483,  0.0670069,  0.0670621,
0.0672172,  0.0672793,  0.0672586,  0.0671793,  0.0672517,  0.0673517,
0.0673862,  0.0676138,  0.0677828,  0.0676586,  0.067531,  0.0676724,
0.0677552,  0.0677586,  0.0678069,  0.0680896,  0.0683448,  0.0682586,
0.0681931,  0.0681966,  0.0683241,  0.0684931,  0.0684379,  0.0683759,
0.0682379,  0.0679793,  0.0678104,  0.0678172,  0.0676965,  0.0674517,
0.067331,  0.0671621,  0.0667793,  0.0667414,  0.0670207,  0.0673552,
0.0676379,  0.0677414,  0.0679379,  0.068169,  0.0679724,  0.0675896,
0.0673483,  0.0673759,  0.0674483,  0.0678448,  0.0682931,  0.0682103,
0.0682138,  0.068131,  0.0679207,  0.0676862,  0.0676414,  0.0677897,
0.0678448,  0.0679724,  0.0681103,  0.0682586,  0.0681897,  0.0680621,
0.0682034,  0.0683207,  0.0682345,  0.0683,  0.0682207,  0.0677724,
0.0675414,  0.067431,  0.0671345,  0.0669448,  0.0665793,  0.0660448,
0.0655655,  0.0652621,  0.064969,  0.0643862,  0.0636724,  0.0630862,
0.0626276,  0.0622414,  0.0622965,  0.0620897,  0.0617138,  0.0616,
0.0619138,  0.0621862,  0.0624931,  0.0626483,  0.0629207,  0.0630276,
0.0631965,  0.0632517,  0.0633759,  0.0637103,  0.0640173,  0.0640448,
0.0641035,  0.0639345,  0.0639345,  0.0637552,  0.0639241,  0.064,
0.0635828,  0.0633103,  0.0635207,  0.0636483,  0.0637069,  0.0638483,
0.0636931,  0.0634897,  0.0635552,  0.0634517,  0.0626552,  0.0621966,
0.0630517,  0.063531,  0.0632207,  0.0629931,  0.0631793,  0.0634862,
0.0640655,  0.0648207,  0.065131,  0.0650103,  0.0648828,  0.0643828,
0.0642069,  0.0645138,  0.0649345,  0.0650138,  0.0649552,  0.0652483,
0.0654207,  0.0656793,  0.0655862,  0.0652241,  0.0655483,  0.0665241,
0.066469,  0.0662793,  0.0663965,  0.0663621,  0.0658276,  0.0658483,
0.0661793,  0.0665207,  0.0665828,  0.066869,  0.0671793,  0.0671897,
0.0677759,  0.0686172,  0.0685586,  0.0681586,  0.0683483,  0.0696345,
0.0698759,  0.0682621,  0.0667586,  0.0664483,  0.0667621,  0.0659759,
0.0648931,  0.0645448,  0.0643172,  0.0638379,  0.0634759,  0.0626655,
0.0637379,  0.0657414,  0.0666138,  0.0673759,  0.0677,  0.0673897,
0.067631,  0.0686103,  0.0694,  0.0684793,  0.0686069,  0.0700897,
0.071731,  0.0736035,  0.0717759,  0.0691724,  0.0684621,  0.0641414,
0.0620966,  0.0687931,  0.0717793,  0.0708931,  0.0718103,  0.0671759,
0.0670345,  0.0687793,  0.0750138,  0.0698379,  0.0592966,  0.0593862,
0.067831,  0.0867828])

    def test_read_envi_file(self):
        s = extract_spectra_from_file(os.path.join(TEST_INPUTS_DIRECTORY,
                                            "atsc15_targets_avg_all_envi.sli"),
                                      "envi")

        assert_allclose(s.wavelengths, self.correct_wavelengths)
        assert_allclose(s.values, self.correct_values)


